@prefix : <https://locorda.dev/example/personal_notes_app/mappings/category-v1#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix mc: <https://w3id.org/solid-crdt-sync/vocab/merge-contract#> .
@prefix algo: <https://w3id.org/solid-crdt-sync/vocab/crdt-algorithms#> .
@prefix mappings: <https://w3id.org/solid-crdt-sync/mappings/> .
@prefix schema: <https://schema.org/> .
@prefix pnotes: <https://locorda.dev/example/personal_notes_app/vocabulary/personal-notes#> .

# CRDT Document Mapping for Notes Categories
# Defines merge strategies for NotesCategory properties
# TODO: generate from Dart code annotations

<> a mc:DocumentMapping ;
    rdfs:label "Notes Category CRDT Document Mapping v1" ;
    rdfs:comment "Defines how note categories should merge when conflicts occur during sync." ;
    mc:imports ( mappings:core-v1 ) ;
    mc:predicateMapping ( <#settings-mappings> ) ;
    mc:classMapping ( [
        a mc:ClassMapping ;
        mc:appliesToClass pnotes:NotesCategory ;
        mc:rule
            [ mc:predicate schema:name ; algo:mergeWith algo:LWW_Register ],
            [ mc:predicate schema:description ; algo:mergeWith algo:LWW_Register ],
            [ mc:predicate pnotes:displaySettings ; algo:mergeWith algo:LWW_Register ],
            [ mc:predicate pnotes:archived ; algo:mergeWith algo:LWW_Register ],
            [ mc:predicate schema:dateCreated ; algo:mergeWith algo:LWW_Register ]
    ] ) .


<#settings-mappings> a mc:PredicateMapping;
  # we were a bit lazy and did not assign a RDF class IRI to CategoryDisplaySettings
  # so we use a PredicateMapping with rules for all predicates used in that blank node
   mc:rule
     [ mc:predicate pnotes:categoryColor; algo:mergeWith algo:LWW_Register ], 
     [ mc:predicate pnotes:categoryIcon; algo:mergeWith algo:LWW_Register ] . 
